import{f as n,r as l,e as w,j as e,P as B}from"./index-DKYCmnMZ.js";import{u as N,C as F,a as O,c as u,d as U,e as k,f as a,g as D}from"./CrudInput-CIJeCB1M.js";import{C as q}from"./ClientRouter-B1RYgFJW.js";import{c as _,o as I}from"./index.es-gRuHa-HP.js";import{B as R}from"./Button-gzgfriZS.js";import{g as L}from"./suppliers-v6ASJCyT.js";import"./Search-DvZNMIQ2.js";const o="productBuys";function M(t){return t.map(({...s})=>({...s}))}async function V(){const t=await n({resource:o+"?includeSuplier=true"});return M(t)}async function $({data:t}){return await n({resource:o,data:t,method:"POST",all:!0})}async function A({id:t,data:s}){return await n({resource:o+"/"+t,data:s,method:"PUT",all:!0})}async function G({id:t}){return await n({resource:o+"/"+t,method:"DELETE",all:!0})}function Y(){const{entityName:t,pluralEntityName:s,head:i,table:p,form:m,confirm:x,progress:f,datalist:h,$form:j,handleModeNew:y,handleModeDelete:C,hanleCancel:c,handleSubmit:P,handleDelete:v,handleSearch:S}=N({entityName:"Venta",pluralEntityName:"Ventas",searchFields:["name","description"],crudGet:V,crudStorage:$,crudUpdate:A,crudDestroy:G}),[b,g]=l.useState([]),[T,E]=l.useState([]);return l.useEffect(()=>{L().then(r=>g(r)),w().then(r=>E(r))},[]),e.jsxs(B,{className:"flex flex-col gap-7 w-full p-3",children:[e.jsx(F,{title:s,icon:_,isOpen:i,onClickNew:y,handleSearch:S}),e.jsx(O,{titles:["Fecha","Proveedor","Total"],dataList:h,isOpen:p,onRowPrint:r=>{var d;return e.jsxs("tr",{children:[e.jsx(u,{value:r.date_str}),e.jsx(u,{value:(d=r==null?void 0:r.suplier)==null?void 0:d.name}),e.jsx(u,{value:"$"+r.total}),e.jsx(U,{children:e.jsx(R,{icon:I,type:"delete",onClick:()=>C(r),classIcon:"text-[--c3-txt2]"})})]},r.id)}}),e.jsxs(k,{title:t,isOpen:m,onClickCancel:c,onSubmit:P,formRef:j,children:[e.jsx(a,{label:"Fecha de venta",type:"date",name:"date_buy",required:!0}),e.jsx(a,{label:"Iva",placeholder:"Escriba el iva  ",name:"tax",required:!0}),e.jsxs(a,{label:"Proveedor",name:"suplier_id",type:"select",required:!0,children:[e.jsx("option",{value:"",children:"Seleccione un proveedor"}),b.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsxs(a,{label:"Usuario",name:"user_id",type:"select",required:!0,children:[e.jsx("option",{value:"",children:"Seleccione un usuario"}),T.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsx(D,{isOpen:x,text:"Â¿Seguro de eliminar esta venta?",onClickDelete:v,onClickCancel:c}),e.jsx(q,{isOpen:f,text:"Procesando tu solicitud..."})]})}export{Y as default};
